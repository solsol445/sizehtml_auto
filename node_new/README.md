# 이미지 리사이징 프로그램 (손실 최소화)

Node.js 기반의 고품질 이미지 리사이징 도구입니다. Sharp 라이브러리를 사용하여 이미지 손실을 최소화하면서 원하는 크기로 변환합니다.

## 📋 주요 기능

- **손실 최소화 리사이징**: Lanczos3 알고리즘 사용으로 고품질 유지
- **자동 크롭**: 목표 비율에 맞춰 중앙 기준으로 자동 잘라내기
- **배치 처리**: img_in 폴더의 모든 JPG 이미지를 한번에 처리
- **사용자 입력**: 원하는 가로/세로 크기를 직접 입력
- **웹 인터페이스**: 브라우저에서 직관적인 이미지 처리
- **실시간 개발**: 코드 변경 시 자동 서버 재시작

## 🔧 설치 방법

### 1. Node.js 설치 확인

```powershell
node --version
```

Node.js가 없다면 [nodejs.org](https://nodejs.org)에서 설치하세요.

### 2. 필요한 패키지 설치

```powershell
cd node
npm install
```

## 📁 폴더 구조

```
node/
├── img_in/          # 원본 이미지를 여기에 넣으세요
├── img_out/         # 리사이징된 이미지가 저장됩니다
├── public/          # 웹 인터페이스 파일들
│   └── index.html   # 웹 UI
├── resize.js        # 이미지 처리 로직
├── server.js        # 웹 서버
├── package.json
└── README.md
```

## 🚀 사용 방법

### 1. 콘솔 버전 (기존)

```powershell
cd node
npm start
```

### 2. 웹 버전 (권장)

```powershell
cd node
npm run web
```

### 3. 개발 모드 (실시간 재시작)

```powershell
cd node
npm run dev
```

## 🌐 웹 인터페이스 기능

### 📤 **이미지 업로드 & 처리**

- 드래그 앤 드롭으로 여러 이미지 동시 업로드
- 가로/세로 크기 입력 (예: 750x1000)
- 실시간 처리 진행률 표시
- 고품질 리사이징 (손실 최소화)

### 📁 **폴더별 갤러리**

- 크기별로 자동 폴더 생성 (예: `750x1000`, `1920x1080`)
- 각 폴더의 이미지 개수 표시
- 썸네일 그리드로 이미지 미리보기
- 폴더 클릭 시 갤러리 뷰로 전환

### 🖼️ **갤러리 뷰**

- 폴더 클릭 시 해당 폴더의 모든 이미지 표시
- 이미지 클릭 시 모달로 큰 화면에서 보기
- 뒤로가기 버튼으로 폴더 목록으로 돌아가기
- 파일명과 파일 크기 정보 표시

### 🎨 **모던한 UI**

- 반응형 디자인 (모바일 지원)
- 그라데이션 배경과 카드 디자인
- 호버 효과와 애니메이션
- 직관적인 사용자 인터페이스

## 💡 작동 원리

프로그램은 이미지 손실을 최소화하기 위해 다음 순서로 작업합니다:

1. **원본 이미지 분석**: 원본 크기와 비율 확인
2. **목표 비율 계산**: 입력받은 크기의 가로세로 비율 계산
3. **크롭 영역 계산**: 원본을 목표 비율에 맞춰 잘라낼 영역 계산
4. **중앙 기준 크롭**: 이미지 중심을 기준으로 잘라내기
5. **고품질 리사이징**: Lanczos3 알고리즘으로 목표 크기로 변환
6. **최적화 저장**: mozjpeg 압축으로 고품질(95%) 저장

## 📝 예시

### 입력

- 원본 이미지: `2000x2000px`
- 목표 크기: `750x1000px`

### 처리 과정

1. 목표 비율 계산: `750 / 1000 = 0.75`
2. 잘라낼 영역: `1500x2000px` (중앙 기준)
3. 리사이징: `750x1000px`

### 결과

- 비율이 맞춰진 고품질 이미지 생성
- 이미지 왜곡 없이 깔끔한 결과

## ⚙️ 개발 모드

### 실시간 개발 환경

```powershell
npm run dev
```

**자동 재시작 기능:**

- `server.js`, `resize.js` 파일 변경 시 자동 재시작
- `public/` 폴더의 HTML, CSS 파일 변경 시 자동 재시작
- `img_in/`, `img_out/` 폴더는 무시 (이미지 파일들)

### 감시 파일

- `server.js` - 메인 서버 파일
- `resize.js` - 이미지 처리 로직
- `public/**/*` - 웹 인터페이스 파일들

## 🔍 지원 형식

- **입력**: JPG, JPEG
- **출력**: JPG (고품질)

## ⚠️ 문제 해결

### "sharp 모듈을 찾을 수 없습니다" 오류

```powershell
npm install
```

### "img_in 폴더를 찾을 수 없습니다" 오류

- `node` 폴더 내부에서 실행하는지 확인
- `img_in` 폴더가 존재하는지 확인

### 이미지 처리 실패

- 이미지 파일이 손상되지 않았는지 확인
- 파일 형식이 JPG/JPEG인지 확인

### 웹 서버 오류

- 포트 3000이 사용 중인지 확인
- `npm run dev`로 개발 모드 실행

## 📊 성능

- **처리 속도**: 약 1-2초/장 (이미지 크기에 따라 다름)
- **품질**: 원본의 95% 이상 유지
- **메모리**: 이미지당 약 50-100MB 사용
- **웹 서버**: 실시간 개발 모드 지원

## 🚀 빠른 시작

1. **패키지 설치**

   ```powershell
   cd node
   npm install
   ```
2. **개발 서버 실행**

   ```powershell
   npm run dev
   ```
3. **브라우저에서 접속**

   ```
   http://localhost:4010
   ```
4. **이미지 업로드 및 처리**

   - 이미지 파일들을 선택
   - 가로/세로 크기 입력
   - "Process Images" 버튼 클릭
5. **결과 확인**

   - 폴더별로 정리된 이미지 확인
   - 갤러리 뷰로 상세 보기

## 📄 라이선스

ISC License

---

**개발 환경**: Node.js + Sharp + Express
**개발 도구**: Nodemon (실시간 재시작)
**작성일**: 2025-10-16
